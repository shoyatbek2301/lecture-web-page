<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explorer Adventure</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background-color: #1a1a1a; color: white; }
        canvas { background: #fff; display: block; margin: auto; border: 2px solid #000; }
        button { padding: 10px 20px; font-size: 16px; margin-top: 10px; cursor: pointer; background-color: #28a745; color: white; border: none; border-radius: 5px; }
        button:hover { background-color: #218838; }
        #timer { font-size: 18px; margin-top: 10px; }
        .document { max-width: 800px; margin: auto; background: white; color: black; padding: 20px; border-radius: 10px; }
    </style>
</head>
<body>
    <h1>Explorer Adventure</h1>
    <p>Visit all locations and return to the starting point before time runs out!</p>
    <canvas id="gameCanvas"></canvas>
    <p id="status">Energy Used: 0</p>
    <p id="timer">Time Left: <span id="time">30</span> sec</p>
    <button onclick="resetGame()">Restart</button>

    <div class="document">
        <h2>Game Design Document</h2>
        <p><b>Game Name:</b> Explorer Adventure</p>
        <p><b>Goal:</b> Visit all locations and return to the start using the least energy.</p>
        <p><b>Visual Design:</b> Simple map with clear paths and points.</p>
        <p><b>Mechanics:</b></p>
        <ul>
            <li>Click on locations to select a route.</li>
            <li>Moving costs energy.</li>
            <li>Finish all locations in 30 seconds.</li>
            <li>Lower energy usage gives a better score.</li>
        </ul>

        <h2>Design Thinking Steps</h2>
        <p><b>Empathize:</b> We analyzed travel-based games.</p>
        <p><b>Define:</b> The goal is to make route planning fun.</p>
        <p><b>Ideate:</b> Clickable map, energy system, and timer.</p>
        <p><b>Prototype:</b> A simple web game was created using HTML, CSS, and JavaScript.</p>
        <p><b>Test:</b> The game was played and improved.</p>
    </div>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        canvas.width = 500; canvas.height = 500;

        let nodes = [ { x: 100, y: 100 }, { x: 400, y: 100 }, { x: 100, y: 400 }, { x: 400, y: 400 }, { x: 250, y: 250 } ];
        let edges = [ [0, 1, 4], [0, 2, 3], [0, 4, 2], [1, 3, 5], [1, 4, 3], [2, 3, 4], [2, 4, 1], [3, 4, 2] ];

        let path = [];
        let totalEnergy = 0;
        let timeLeft = 30;
        let timer;

        function drawMap() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            edges.forEach(([a, b, cost]) => {
                ctx.beginPath();
                ctx.moveTo(nodes[a].x, nodes[a].y);
                ctx.lineTo(nodes[b].x, nodes[b].y);
                ctx.strokeStyle = "gray";
                ctx.stroke();
                ctx.fillStyle = "red";
                ctx.fillText(cost, (nodes[a].x + nodes[b].x) / 2, (nodes[a].y + nodes[b].y) / 2);
            });
            nodes.forEach((node, index) => {
                ctx.beginPath();
                ctx.arc(node.x, node.y, 10, 0, Math.PI * 2);
                ctx.fillStyle = "blue";
                ctx.fill();
                ctx.fillStyle = "white";
                ctx.fillText(index, node.x - 5, node.y + 5);
            });
        }

        canvas.addEventListener("click", (e) => {
            let x = e.offsetX, y = e.offsetY;
            nodes.forEach((node, index) => {
                let dx = node.x - x, dy = node.y - y;
                if (dx * dx + dy * dy < 100) { 
                    if (!path.includes(index)) {
                        path.push(index);
                        if (path.length > 1) {
                            let prev = path[path.length - 2];
                            let edge = edges.find(edge => (edge[0] === prev && edge[1] === index) || (edge[1] === prev && edge[0] === index));
                            if (edge) totalEnergy += edge[2];
                        }
                    }
                    drawPath();
                }
            });
        });

        function drawPath() {
            drawMap();
            ctx.strokeStyle = "yellow";
            ctx.lineWidth = 2;
            for (let i = 0; i < path.length - 1; i++) {
                let a = nodes[path[i]];
                let b = nodes[path[i + 1]];
                ctx.beginPath();
                ctx.moveTo(a.x, a.y);
                ctx.lineTo(b.x, b.y);
                ctx.stroke();
            }
            document.getElementById("status").innerText = `Energy Used: ${totalEnergy}`;
        }

        function startTimer() {
            clearInterval(timer);
            timeLeft = 30;
            document.getElementById("time").innerText = timeLeft;
            timer = setInterval(() => {
                timeLeft--;
                document.getElementById("time").innerText = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    alert("Time's up! Try again.");
                    resetGame();
                }
            }, 1000);
        }

        function resetGame() {
            path = [];
            totalEnergy = 0;
            drawMap();
            document.getElementById("status").innerText = "Energy Used: 0";
            startTimer();
        }

        drawMap();
        startTimer();
    </script>
</body>
</html>